{
  "$schema": "https://adaptivecards.io/schemas/adaptive-card.json",
  "version": "1.5",
  "type": "AdaptiveCard",
  "msteams": {
    "width": "full"
  },
  "body": [
    {
      "type": "TextBlock",
      "text": "ğŸš¨ New Issue Reported",
      "size": "ExtraLarge",
      "weight": "Bolder",
      "color": "Attention",
      "wrap": true,
      "spacing": "Large"
    },
    {
      "type": "TextBlock",
      "text": "A new report issue has been submitted on the list. Click below to view more details.",
      "wrap": true,
      "spacing": "Small"
    },
    {
      "type": "TextBlock",
      "text": "ğŸ“Œ **Issue:** @{triggerBody()?['Title']}",
      "wrap": true,
      "size": "Large",
      "weight": "Bolder",
      "spacing": "Medium"
    },
    {
      "type": "ActionSet",
      "actions": [
        {
          "type": "Action.ToggleVisibility",
          "title": "ğŸ” Show/Hide Details",
          "targetElements": [
            "detailsSection"
          ]
        }
      ],
      "spacing": "Medium"
    },
    {
      "type": "Container",
      "id": "detailsSection",
      "isVisible": false,
      "items": [
        {
          "type": "FactSet",
          "facts": [
            {
              "title": "ğŸ“‚ Category:",
              "value": "@{triggerBody()?['Category/Value']}"
            },
            {
              "title": "ğŸ”§ Type of Issue:",
              "value": "@{triggerBody()?['TypeofIssue/Value']}"
            },
            {
              "title": "ğŸ†” File Number:",
              "value": "@{triggerBody()?['ReportID']}"
            },
            {
              "title": "ğŸ”„ Workflow-State:",
              "value": "@{triggerBody()?['State/Value']}"
            },
            {
              "title": "ğŸ‘¤ Created by:",
              "value": "@{triggerBody()?['DisplayName/DisplayName']}"
            },
            {
              "title": "ğŸ•’ Date & Time:",
              "value": "@{formatDateTime(triggerBody()?['Dateofoccurence'], 'MM-dd-yyyy')} @{formatDateTime(triggerBody()?['Dateofoccurence'], 'HH:mm')}"
            },
            {
              "title": "ğŸ“ Site Location:",
              "value": "@{triggerBody()?['SiteLocation/Value']}"
            },
            {
              "title": "ğŸ‘¥ Affected Users:",
              "value": "@{triggerBody()?['Numberofaffectedusers']}"
            }
          ]
        },
        {
          "type": "TextBlock",
          "text": "ğŸ“ **Details:**",
          "weight": "Bolder",
          "spacing": "Medium"
        },
        {
          "type": "TextBlock",
          "text": "@{triggerBody()?['Details']}",
          "wrap": true
        }
      ]
    },
    {
      "type": "TextBlock",
      "text": "ğŸ”’ *This adaptive card is for PH Traffic only*",
      "isSubtle": true,
      "size": "Small",
      "horizontalAlignment": "Center",
      "spacing": "ExtraLarge"
    }
  ],
  "speak": "This adaptive card is for PH Traffic Only"
}
